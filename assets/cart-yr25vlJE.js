import{S as R,ae as S,ad as q,R as A,G as I,c as _,Y as o,$ as f,X as r,L as s,aw as k,ai as l,W as V,_ as z,O as v,af as u,ag as g,aR as D,V as E,aj as j,am as F}from"./index-DE2ZxSef.js";import{V as d,a as G,b as h}from"./route-block-BPskVbgn.js";import{V as y}from"./VDivider-BLGl6AYq.js";import{V as O,a as P}from"./VList-BHL_UkBb.js";const T={class:"text-center"},U={__name:"cart",setup(W){const{apiAuth:n}=F(),i=R(),C=S(),b=q(),{t:w}=A(),c=I([]),p=async()=>{try{const{data:a}=await n.get("/user/cart");c.value=a.result}catch(a){console.log(a)}};p();const x=_(()=>c.value.reduce((a,e)=>a+e.product.price*e.quantity,0)),B=_(()=>c.value.reduce((a,e)=>a+e.product.price*e.quantity,0)),$=async()=>{var a,e;try{await n.post("/order"),i.cart=0,C.push("/order")}catch(t){console.log(t),b({text:w("api."+(((e=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:e.message)||"unknownError")),snackbarProps:{color:"red"}})}},m=async(a,e)=>{try{const{data:t}=await n.patch("/user/cart",{product:a,quantity:e});i.cart=t.result,p()}catch(t){console.log(t)}};return(a,e)=>(o(),f(G,null,{default:r(()=>[s(d,{cols:"12"},{default:r(()=>[k("h1",T,l(a.$t("nav.cart")),1)]),_:1}),s(y),s(d,{cols:"12"},{default:r(()=>[s(O,{lines:"two"},{default:r(()=>[(o(!0),V(v,null,z(c.value,(t,L)=>(o(),V(v,{key:t._id},[s(P,{title:t.product.name,subtitle:t.product.price,"active-class":"bg-red",active:!t.product.sell},{prepend:r(()=>[s(D,{rounded:"0"},{default:r(()=>[s(E,{src:t.product.image},null,8,["src"])]),_:2},1024)]),append:r(()=>[s(u,{color:"red",icon:"mdi-minus",size:"small",class:"ml-2",onClick:N=>m(t.product._id,-1)},null,8,["onClick"]),g(" "+l(t.quantity)+" ",1),s(u,{color:"green",icon:"mdi-plus",size:"small",class:"mr-2",onClick:N=>m(t.product._id,1)},null,8,["onClick"])]),_:2},1032,["title","subtitle","active"]),L<c.value.length-1?(o(),f(y,{key:0})):j("",!0)],64))),128))]),_:1})]),_:1}),s(d,{cols:"12",class:"text-center"},{default:r(()=>[k("p",null,l(x.value),1),s(u,{color:"primary",disabled:!B.value,onClick:$},{default:r(()=>[g(l(a.$t("cart.checkout")),1)]),_:1},8,["disabled"])]),_:1})]),_:1}))}};typeof h=="function"&&h(U);export{U as default};
